(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{401:function(e,t,n){e.exports=n(914)},901:function(e,t,n){},914:function(e,t,n){"use strict";n.r(t);var o=n(32),r=n(33),a=n(35),c=n(34),i=n(36),l=n(1),u=n(7),s=n(398),h=n(223),p=n(16),m=p.Tree.TreeNode,d=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return(n=Object(a.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).onSelectTreeNode=function(e){var t=n.props,o=t.songList,r=t.onSelectSong,a=e[0],c=o.find(function(e){return e.id===a});c&&r(c)},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.songList,n=e.searchString,o=e.onSelectSong;if(n){var r=t.map(function(e){return e}).sort(g(n));return l.createElement(p.List,{itemLayout:"horizontal",dataSource:r,renderItem:function(e){return l.createElement(p.List.Item,{onClick:function(){return o(e)}},l.createElement(p.List.Item.Meta,{title:"".concat(e.artist," - ").concat(e.name)}))}})}var a=S(t).sort(b).map(function(e){return e.sort(y)});return l.createElement(p.Tree,{showIcon:!0,switcherIcon:l.createElement(p.Icon,{type:"down"}),onSelect:this.onSelectTreeNode},a.map(function(e,t){var n="".concat(t);return l.createElement(m,{key:n,title:"".concat(e[0].artist," (").concat(e.length,")")},e.map(function(e){return l.createElement(m,{key:e.id,title:e.name})}))}))}}]),t}(l.Component),f=function(e,t){var n=e.name.toLowerCase(),o=e.artist.toLowerCase();return n.startsWith(t)||o.startsWith(t)?1:n.includes(t)||o.includes(t)?.5:0},g=function(e){var t=e.toLowerCase();return function(e,n){var o=f(e,t),r=f(n,t);return o<r?1:o>r?-1:0}},S=function(e){var t=[],n=!0,o=!1,r=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done);n=!0){for(var i=a.value,l=!1,u=0,s=t;u<s.length;u++){var h=s[u];h[0].artist===i.artist&&(h.push(i),l=!0)}l||t.push([i])}}catch(p){o=!0,r=p}finally{try{n||null==c.return||c.return()}finally{if(o)throw r}}return t.sort(function(e,t){var n=e[0].artist.toUpperCase(),o=t[0].artist.toUpperCase();return n<o?-1:n>o?1:0})},v=function(e){return function(t,n){var o=e(t).toUpperCase(),r=e(n).toUpperCase();return o<r?-1:o>r?1:0}},y=v(function(e){return e.name}),b=v(function(e){return e[0].artist}),T=function(e){function t(){return Object(o.a)(this,t),Object(a.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.createElement(p.Spin,{size:"large",className:"absoluteCenter"})}}]),t}(l.Component),E=function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e))).onSearchSong=function(e){n.setState({searchString:e.length>0?e:void 0})},n.onSelectSong=function(e){n.props.history.push("/song/"+"".concat(e.url))},fetch("/content/list.json").then(function(e){return e.json()}).then(function(e){return n.setState({songList:e})});var r=n.props.match.params.errorMsg;return void 0!==r&&p.message.error(r),n.state={},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){window.scrollTo(0,0)}},{key:"render",value:function(){var e=this,t=this.state.songList,n=this.state.searchString;return void 0===t?l.createElement(T,null):l.createElement("div",null,l.createElement(p.Typography.Title,null,"Select song (",t.length,")"),l.createElement(p.Input.Search,{placeholder:"Search text",enterButton:"Search",size:"default",onChange:function(t){return e.onSearchSong(t.target.value)},allowClear:!0}),l.createElement(d,{songList:t,searchString:n,onSelectSong:this.onSelectSong}))}}]),t}(l.Component),j=(n(901),p.Typography.Title,p.Typography.Text,function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e))).state={},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.song,n=e.defaultSelectedVersion,o=e.onSelectVersion,r=t.versions;return l.createElement("div",{className:"versionSelector"},r.length>1&&l.createElement("div",null,r.map(function(e,t){return l.createElement(p.Button,{key:"".concat(t),onClick:function(){return o(t)},type:e===n?"primary":"default"},e.name)})))}}]),t}(l.Component)),O=(p.Typography.Title,p.Typography.Text,p.Typography.Paragraph,function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e))).touchStartTime=void 0,n.touchStartLocation=void 0,n.onDoubleClick=function(){n.props.onClick()},n.onTouchStart=function(e){n.touchStartTime=window.performance.now(),n.touchStartLocation={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}},n.onTouchEnd=function(e){var t=window.performance.now()-n.touchStartTime,o={x:e.changedTouches[0].clientX-n.touchStartLocation.x,y:e.changedTouches[0].clientY-n.touchStartLocation.y},r=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2));t<=150&&r<=20&&n.props.onClick()},n.state={},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.version.content.split("\n");return l.createElement("div",{onDoubleClick:this.onDoubleClick,onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd},e.map(function(e,t){return l.createElement("pre",{key:t,className:"songParagraph"},e)}))}}]),t}(l.Component)),w=n(396),C={min:600,max:60,default:180},k=function(e){return"ass-".concat(e.id)},A=function(e){if(void 0!==localStorage){var t=localStorage.getItem(k(e));if(null!==t)return Number(t)}return void 0!==e.duration?e.duration:C.default},x=function(e,t,n){var o=void 0===n?localStorage:n;o&&o.setItem(k(e),String(t))},M=function(e,t,n){return t+e*(n-t)},L=(p.Typography.Title,p.Typography.Text),V=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e))).onSliderChange=function(e){n.props.onSetSpeed(I(e))},n.afterSliderChange=function(e){x(n.props.songVersion,I(e))},n.state={},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.enabled,n=e.autoScrollSpeed,o=e.onToggle;return l.createElement("div",null,l.createElement(p.Tooltip,{title:"Also activated by poking / double-clicking anywhere!",mouseEnterDelay:1},l.createElement(p.Button,{onClick:o,type:t?"primary":"default"},"Autoscroll ".concat(t?"ON":"OFF"))),l.createElement(p.Slider,{className:"autoScrollSlider",min:0,max:100,value:F(n),marks:Object(w.a)({},F(C.default),""),onChange:this.onSliderChange,onAfterChange:this.afterSliderChange}),l.createElement("div",{className:"autoScrollValueDiv"},l.createElement(L,{className:"autoScrollValueLabel"},"".concat(Math.floor(n/60)," min ").concat(Math.floor(n)%60>0?Math.floor(n)%60+" sec":""))))}}]),t}(l.Component),F=function(e){return M((e-C.min)/(C.max-C.min),0,100)},I=function(e){return M(e/100,C.min,C.max)},N=n(397),B=p.Typography.Title,D=(p.Typography.Text,function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e))).scrollDivRef=void 0,n.isCurrentlyMounted=!1,n.lastAutoScrollUpdate=void 0,n.scrollingFractions=0,n.onSelectVersion=function(e){n.props.history.push("/song/".concat(n.props.match.params.uri,"/").concat(e))},n.goToBeginning=function(){N.animateScroll.scrollToTop()},n.onToggleAutoScroll=function(){"autoScrollActive"in n.state&&n.setState({autoScrollActive:!n.state.autoScrollActive})},n.onSetAutoScrollSpeed=function(e){n.setState({autoScrollSpeed:e})},n.returnToPreviousMenu=function(){n.props.history.push("/")},n.updateAutoScroll=function(){if(n.isCurrentlyMounted&&"autoScrollActive"in n.state){var e=window.performance.now();if(n.state.autoScrollActive&&n.scrollDivRef&&void 0!==n.lastAutoScrollUpdate){var t=n.state.autoScrollSpeed,o=n.scrollDivRef.getBoundingClientRect(),r=(o.bottom-o.top-window.innerHeight)*(e-n.lastAutoScrollUpdate)/(1e3*t)+n.scrollingFractions,a=Math.floor(r),c=r-a;n.scrollingFractions=c,window.scrollBy(0,a),window.requestAnimationFrame(n.updateAutoScroll)}else window.requestAnimationFrame(n.updateAutoScroll),n.scrollingFractions=0;n.lastAutoScrollUpdate=e}};var r=e.match.params.uri;return fetch("/content/".concat(r)).then(function(e){return e.json()}).catch(function(){n.props.history.replace("/error/Song not found :(")}).then(function(t){void 0!==t&&n.selectVersionFromProps(t,e)}),n.state={},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.isCurrentlyMounted=!0,window.requestAnimationFrame=window.requestAnimationFrame||function(e){return window.setTimeout(e,50)},window.requestAnimationFrame(this.updateAutoScroll),window.scrollTo(0,0)}},{key:"componentWillUnmount",value:function(){this.isCurrentlyMounted=!1}},{key:"componentWillReceiveProps",value:function(e){"song"in this.state&&this.selectVersionFromProps(this.state.song,e)}},{key:"selectVersionFromProps",value:function(e,t){var n=t.match.params.selectedVersionIndex,o=e.versions[void 0!==n&&n<e.versions.length?n:0];this.setState({song:e,selectedVersion:o,autoScrollSpeed:A(o),autoScrollActive:!1})}},{key:"render",value:function(){var e=this;if("song"in this.state){var t=this.state,n=t.song,o=t.selectedVersion,r=t.autoScrollActive,a=t.autoScrollSpeed;return l.createElement("div",{ref:function(t){return e.scrollDivRef=t}},l.createElement(B,null,n.artist),l.createElement(B,{level:2},n.name),l.createElement("div",null,l.createElement(j,{song:n,defaultSelectedVersion:o,onSelectVersion:this.onSelectVersion}),l.createElement(p.Affix,{className:"autoScrollConfigBox",offsetTop:0},l.createElement(V,{songVersion:o,enabled:r,autoScrollSpeed:a,onToggle:this.onToggleAutoScroll,onSetSpeed:this.onSetAutoScrollSpeed}))),l.createElement("br",null),l.createElement(p.Tag,{color:"blue"},o.instrument),"guitar"===o.instrument&&l.createElement(p.Tag,{color:"volcano"},o.tuning),l.createElement(O,{song:n,version:o,onClick:this.onToggleAutoScroll}),l.createElement("br",null),l.createElement("div",null,l.createElement(p.Button,{onClick:this.goToBeginning},"To beginning"),l.createElement(p.Button,{onClick:this.returnToPreviousMenu},"To song selection")))}return l.createElement(T,null)}}]),t}(l.Component)),P=(p.Typography.Title,p.Typography.Text),U=function(e){function t(){return Object(o.a)(this,t),Object(a.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.createElement("div",null,l.createElement(P,null,"Page not found :("))}}]),t}(l.Component),R=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e))).state={},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state.bgUrl;return l.createElement("div",{style:{backgroundImage:e?"url(".concat(e,")"):"",backgroundSize:"auto 100%",backgroundPosition:"center",backgroundRepeat:"no-repeat"}},l.createElement(s.a,null,l.createElement(h.c,null,l.createElement(h.a,{exact:!0,path:"/",component:E}),l.createElement(h.a,{path:"/error/:errorMsg",component:E}),l.createElement(h.a,{path:"/song/:uri/:selectedVersionIndex?",component:D}),l.createElement(h.a,{component:U}))))}}]),t}(l.Component),q=document.getElementById("root");Object(u.render)(l.createElement(R,null),q)}},[[401,2,1]]]);
//# sourceMappingURL=main.df810285.chunk.js.map